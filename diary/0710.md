# 6μΌμ°¨

λ‚ μ§: 2023λ…„ 7μ›” 10μΌ

## **π“ λ©ν‘**

1. μ•½ 400κ°μ λ°μ΄ν„° λΌλ²¨λ§
2. YOLOv8λ΅ λ°μ΄ν„° ν•™μµ
3. κµ¬μ²΄μ μΈ ν”„λ΅μ νΈ μ£Όμ  μ„ μ •

## **π“ ν•™μµ κ²°κ³Ό**

- κ²€μ¶μ¨μ΄ λ„λ¬΄ λ‚®μ•„μ§
- μ¤κ²€μ¶μ¨ μ¦κ°€

β†’ λ„λ¬΄ μΌκ΄€μ μΈ λ°μ΄ν„° μ‚¬μ©.

## **π“ ν•μ΄νΌνλΌλ―Έν„°(Hyperparameter)μ— λ€ν•΄**

<aside>
π’΅ μ•κ³ λ¦¬μ¦ μ‚¬μ©μκ°€ κ²½ν—μ— μν•΄ μ§μ ‘ μ„Έν…ν•λ” κ°’.

</aside>

- μ •ν•΄μ§„ μµμ μ κ°’μΈ Hyperparameterλ” ****λ¨λΈμ parameter κ°’μ„ μΈ΅μ •ν•κΈ° μ„ν•΄ μ•κ³ λ¦¬μ¦ κµ¬ν„ κ³Όμ €μ—μ„ μ‚¬μ©λλ‹¤.
- Hyperparameterλ” λ¨λΈμ—μ„ μ™Έμ μΈ μ”μ†λ‚ λ°μ΄ν„° λ¶„μ„μ„ ν†µν•΄ μ—†μ–΄μ§€λ” κ°’μ΄ μ•„λ‹λ‹¤.
- μ•κ³ λ¦¬μ¦ λ¨λΈλ¦¬μ λ¬Έμ μ  ν•΄μ†λ¥Ό μ„ν•΄ μ΅°μ λλ‹¤.
- Learning rate(ν•™μµλ¥ ), SVMμ—μ„μ μ½”μ¤νΈ κ°’, KNNμ—μ„μ K κ°μ, epoch λ“±

### **Hyperparameter νλ‹ λ°©λ²•**

<aside>
π’΅ μµμ μ κ°’μ„ μ°ΎκΈ° μ„ν• κ³Όμ •.

</aside>

- Manual Search, Grid Search, Random Search, Bayesian Optimization, Non-Probabilistic, Evolutionary Optimization, Gradient-based Optimization, Early Stopping

### λ„¤νΈμ›ν¬ κµ¬μ΅° κ΄€λ ¨ Hyperparameter

- μ€λ‹‰μΈµμ λ‰΄λ° κ°μ
    - ν›λ ¨ λ°μ΄ν„°μ— λ€ν• ν•™μµ μµμ ν™” κ²°μ • λ³€μ
    - μ²« μ€λ‹‰μΈµμ λ‰΄λ° μκ°€ μ…λ ¥μΈµλ³΄λ‹¤ ν° κ²ƒμ΄ ν¨κ³Όμ μ΄λ‹¤.
- Dropout
    - κ³Όμ ν•©μ„ ν”Όν•κΈ° μ„ν• μ •κ·ν™” κΈ°λ²•
    - ν•™μµλ°μ΄ν„°μ— κ³Όμ ν•©ν•κ² ν•™μµλ modelμ„ μ‹¤μ λ΅ μ‚¬μ©ν•κΈ° μ„ν•΄ λ²”μ©μ„±μ„ μ„ν• κΈ°λ²•μΌλ΅ μ€λ‹‰μΈµμ λ‰΄λ°λ“¤μ„ μΌμ • λΉ„μ¨λ΅ λ°°μ ν•κ³  ν•™μµμ„ ν•λ‹¤.
- κ°€μ¤‘μΉ μ΄κΈ°ν™”
    - ν•™μµ μ„±λ¥μ— λ€ν• κ²°μ • λ³€μ

### Training κ΄€λ ¨ Hyperparameter

- ν•™μµλ¥  (learning rate)
    - gradientμ λ°©ν–¥μΌλ΅ μ–Όλ§λ‚ λΉ λ¥΄κ² μ΄λ™ν•  κ²ƒμΈμ§€ κ²°μ •ν•λ” λ³€μ
    - λ„λ¬΄ μ‘μΌλ©΄ ν•™μµμ μ†λ„κ°€ λ¦κ³ , λ„λ¬΄ ν¬λ©΄ ν•™μµμ΄ λ¶κ°€ν•λ‹¤.
- λ¨λ©ν…€ (momentum)
    - ν•™μµ λ°©ν–¥μ„ μ μ§€ν•λ ¤λ” μ„±μ§
    - λ¨λ©ν…€μ„ μ‚¬μ©ν•λ©΄ ν•™μµ λ°©ν–¥μ΄ λ°”λ΅ λ°”λ€μ§€ μ•κ³ , μΌμ •ν• λ°©ν–¥μ„ μ μ§€ν•λ©° μ›€μ§μΈλ‹¤. (μ΄λ™λ‰)
    - κ°™μ€ λ°©ν–¥μ ν•™μµμ΄ μ§„ν–‰λλ‹¤λ©΄ κ°€μ†μ„ κ°€μ§€λ©° λ” λΉ λ¥Έ ν•™μµμ„ κΈ°λ€ν•  μ μλ‹¤.
- μ—ν¬ν¬ (epoch, training epochs)
    - μ „μ²΄ νΈλ μ΄λ‹ μ…‹μ΄ μ‹ κ²½λ§μ„ ν†µκ³Όν• νμλ¥Ό μλ―Έν•λ‹¤.
    - ex. 1-epochλ” μ „μ²΄ νΈλ μ΄λ‹ μ…‹μ΄ ν•λ‚μ μ‹ κ²½λ§μ— μ μ©λμ–΄ μμ „νμ™€ μ—­μ „νλ¥Ό ν†µν•΄ μ‹ κ²½λ§μ„ ν• λ² ν†µκ³Όν–λ‹¤λ” κ²ƒμ„ μλ―Έ
- λ°°μΉ μ‚¬μ΄μ¦ (batch size)
    - λ―Έλ‹ λ°°μΉ ν¬κΈ°(Mini-batch Size)
    - λ°°μΉμ…‹ μν–‰μ„ μ„ν•΄ μ „μ²΄ ν•™μµ λ°μ΄ν„°λ¥Ό λ“±λ¶„ν•λ” ν¬κΈ° (μ „μ²΄ νΈλ μ΄λ‹ μ…‹μ„ μ‘κ² λ‚λ„λ” μ΄μ λ” νΈλ μ΄λ‹ λ°μ΄ν„°λ¥Ό ν†µμ§Έλ΅ μ‹ κ²½λ§μ— λ„£μΌλ©΄ λΉ„ν¨μ¨μ μΈ λ¦¬μ†μ¤ μ‚¬μ©μΌλ΅ ν•™μµ μ‹κ°„μ΄ μ¤λ κ±Έλ¦¬κΈ° λ•λ¬Έμ΄λ‹¤.)
    - κ°€μ© λ©”λ¨λ¦¬ ν¬κΈ°μ™€ epoch μν–‰ μ„±λ¥μ„ κ³ λ ¤
    - μµμ† μ‚¬μ΄μ¦λ” 32μ΄κ³  GPUμ λ¬Όλ¦¬μ μΈ κµ¬μ΅°λ΅ μΈν•΄ ν•­μƒ 2μ μ κ³±μΌλ΅ μ„¤μ •ν•λ‹¤.
- λ°λ³µ (iteration)
    - 1-epochλ¥Ό λ§μΉλ”λ° ν•„μ”ν• λ―Έλ‹λ°°μΉ κ°―μλ¥Ό μλ―Έν•λ‹¤. μ¦‰, 1-epochλ¥Ό λ§μΉλ”λ° ν•„μ”ν• νλΌλ―Έν„° μ—…λ°μ΄ν„° νμμ΄λ‹¤. κ° λ―Έλ‹ λ°°μΉ λ§λ‹¤ νλΌλ―Έν„° μ—…λ°μ΄ν„°κ°€ ν•λ²μ”© μ§„ν–‰λλ―€λ΅ iterationμ€ νλΌλ―Έν„° μ—…λ°μ΄νΈ νμμ΄μ λ―Έλ‹λ°°μΉ κ°μμ΄λ‹¤.
    - ex. 700κ°μ λ°μ΄ν„°λ¥Ό 100κ°μ”© 7κ°μ λ―Έλ‹λ°°μΉλ΅ λ‚λ„μ—μ„λ•, 1-epochλ¥Ό μ„ν•΄μ„λ” 7-iterationμ΄ ν•„μ”ν•λ©° 7λ²μ νλΌλ―Έν„° μ—…λ°μ΄νΈκ°€ μ§„ν–‰λλ‹¤.
- μ†μ‹¤ν•¨μ (Cost Function)
    - μ…λ ¥μ— λ”°λ¥Έ κΈ°λ€ κ°’κ³Ό μ‹¤μ  κ°’μ μ°¨μ΄λ¥Ό κ³„μ‚°ν•λ” ν•¨μ
    - ν‰κ·  μ κ³± μ¤μ°¨
    - κµμ°¨ μ—”νΈλ΅ν”Ό μ¤μ°¨
- μ •κ·ν™” νλΌλ―Έν„° (Regularization parameter)
    - [L1 λλ” L2 μ •κ·ν™” λ°©λ²•](https://niniit.tistory.com/47)Β μ‚¬μ©
    - μ‚¬μ©ν•λ” μΌλ°ν™” λ³€μλ„ ν•μ΄νΌ νλΌλ―Έν„°λ΅ λ¶„λ¥λλ‹¤.

---

---

## **π“ μƒλ΅μ΄ ν”„λ΅μ νΈμ— λ€ν•΄**

- κΈ°μ΅΄μ— ν•κ³  μλ μ°¨λ‰λ²νΈν μΈμ‹ ν”„λ΅μ νΈλ” μ μ‹ λ©μ¶”κ³  μƒλ΅μ΄ ν”„λ΅μ νΈλ¥Ό μ§„ν–‰ν•λ‹¤.
- μ°¨μΆ…μ— λ”°λ¥Έ μ΄μ „μμ„ λ†’μ΄μ— κ΄€ν• ν”„λ΅μ νΈ
- ν”„λ΅μ νΈ μ‹μ‘ μ „μ— μμƒμ²λ¦¬ κ΄€λ ¨ κ³µλ¶€ μ§„ν–‰.

## **π“ κ°λ°ν™κ²½**

- python=3.8
- Flask μ›Ή ν”„λ μ„μ›ν¬
- opencvβ‰¥4.xx

## **π“ λΉ„λ””μ¤ μ¶λ ¥**

- opencvλ¥Ό μ‚¬μ©ν•μ—¬ μμƒμ¶λ ¥
- Flaskλ¥Ό μ‚¬μ©ν•μ—¬ HTTP ν†µμ‹ 
- λ”¥λ¬λ‹ μ—°μ‚°μ„ μ„ν• μ¤νΈλ¦¬λ° λ°©λ²•
    - Jinja ν…ν”λ¦Ώμ„ μ‚¬μ©ν•μ—¬ HTML λ™μ  ν”„λ΅κ·Έλλ°
    
    [[FLASK] 4. μ›Ή νμ΄μ§€μ— λ™μμƒ λ„μ°κΈ°(+ YOLOv5)](https://95mkr.tistory.com/entry/FLASK4)
    

```python
def gen_frames(file_path):    
  cap = cv2.VideoCapture(file_path)
  
  while True:
    _, frame = cap.read()
    if not _:
      break
    else:
      # results = model(frame)
      # annotated_frame = results.render()
      
      ret, buffer = cv2.imencode('.jpg', frame)
      frame = buffer.tobytes()

    yield (b'--frame\r\n'
           b'Content-Type: image/jpeg\r\n\r\n' + frame + b'\r\n')
```

### μ›ΉμΊ μΌλ΅ μ‹¤ν–‰

```python
@app.route('/cam')
def cam():
    return Response(gen_frames(0), mimetype='multipart/x-mixed-replace; boundary=frame')
```

```html
<div class="video-container">
  <img src="{{ cam }}" width="640" height="480">
</div>
```

<p align="center">
  <img src="./img/0710/0710_cam.png" align="center" width="90%">
</p>

### λΉ„λ””μ¤λ΅ μ‹¤ν–‰

```python
@app.route('/video')
def video():
    return Response(gen_frames('./resources/uploaded_video.mp4'), mimetype='multipart/x-mixed-replace; boundary=frame')
```

```html
<div class="video-container">
  <img src="{{ video }}" width="640" height="480">
</div>
```

<p align="center">
  <img src="./img/0710/0710_video.png" align="center" width="90%">
</p>

## **π“ λ‚΄μΌ λ©ν‘**

1. HTML κµ¬μ΅° μ •λ¦¬
    - νμΌ μ—…λ΅λ“ λ¶€λ¶„
    - CSS μ μ©
2. μμƒμ²λ¦¬ κ°μΈν•™μµ
    - μ΄λ―Έμ§€ μƒ‰μƒ ν‘ν„/λ³€ν™/λ¶„λ¦¬
    - μ΄λ―Έμ§€ μ—°μ‚°
    - μ—μ§€κ²€μ¶
    - λ…Έμ΄μ¦ ν•„ν„°λ§
    - μ–΄νμΈ λ³€ν•(νμ „, μ–΄νμΈ, μ›κ·Όλ³€ν™)