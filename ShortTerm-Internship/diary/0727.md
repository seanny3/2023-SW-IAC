# 19ì¼ì°¨

ğŸ“… 2023ë…„ 7ì›” 27ì¼

## **ğŸ“Œ ì˜¤ëŠ˜ ëª©í‘œ**

- 3ì¼ì°¨ ë¼ë²¨ë§ ì‘ì—… ê³„ì†
- ì–´ì œ í•™ìŠµì‹œí‚¨ ëª¨ë¸ë¡œ LPR í…ŒìŠ¤íŠ¸

## **ğŸ“Œ LPR í…ŒìŠ¤íŠ¸**

- LPR(License Plate Recognition)ì€ ìë™ì°¨ ë²ˆí˜¸íŒì„ ì¹´ë©”ë¼ë¡œ ì´¬ì˜í•œ ì´ë¯¸ì§€ë¡œë¶€í„° ì°¨ëŸ‰ë²ˆí˜¸ ë°ì´í„°ë¥¼ ì¶”ì¶œí•´ ë‚´ì£¼ëŠ” ì¥ì¹˜ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
    - ê³¼ê±°ì— ì§„í–‰í–ˆë˜ [ë¼ì¦ˆë² ë¦¬íŒŒì´ì—ì„œ ë™ì‘ë˜ëŠ” ê°„ë‹¨í•œ LPR ì‹œìŠ¤í…œ](https://github.com/hwan1625/Parking-Barrier-using-ANPR-on-RaspberryPi)ì„ êµ¬í˜„í•œ ì ì´ ìˆë‹¤.
- ì˜¤ëŠ˜ì€ ì–´ì œ í•™ìŠµì‹œí‚¨ ëª¨ë¸ì„ ê°€ì§€ê³  ë¡œì»¬ í™˜ê²½ì—ì„œ ì˜ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ì˜€ë‹¤.
- ê¸°ì¡´ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì—¬ ì›í•˜ëŠ” ì¶œë ¥ ê²°ê³¼ë¬¼ì´ ë‚˜ì˜¬ ìˆ˜ ìˆë„ë¡ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ì˜€ë‹¤.

### ìˆ˜ì • ì „ ì½”ë“œ

```python
from ultralytics import YOLO

# YOLOv8
model = YOLO("best.pt")
results = model.predict(frame)   # results = model(frame)
frame = results[0].plot()
```

- ê¸°ì¡´ ì½”ë“œëŠ” bounding boxì™€ íƒì§€ëœ ê°ì²´ì™€ ì´ë¦„ì„ ìë™ìœ¼ë¡œ ë§¤ì¹­ í•´ì£¼ëŠ” í˜•íƒœì˜€ë‹¤.
- ë…ë¦½ì ì¸ ê°ì²´ì— ëŒ€í•´ì„  plot ë©”ì†Œë“œëŠ” í¸ë¦¬í•˜ì§€ë§Œ ê²€ì¶œë˜ëŠ” ì°¨ëŸ‰ë²ˆí˜¸ëŠ” ì¼ì •í•œ ìˆœì„œì— ë”°ë¼ ë‚˜ì—´ë˜ì–´ì•¼ í•˜ëŠ” ì„œë¡œ ì¢…ì†ì ì¸ í˜•íƒœë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ê° í´ë˜ìŠ¤ì— ëŒ€í•œ ë¶€ê°€ì ì¸ ì½”ë©˜íŠ¸ë¥¼ ì œê±°í•˜ê³  ë³´ë‹¤ ë³´ê¸° í¸í•œ bounding boxë¥¼ ê·¸ë¦´ í•„ìš”ê°€ ìˆì—ˆë‹¤.

### Return results

- [**predict**]((https://docs.ultralytics.com/modes/predict/)) ë©”ì†Œë“œëŠ” ì¶”ë¡  ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤.

```python
results = model(frame)

for result in results:
    boxes = result.boxes  # Boxes object for bbox outputs
    masks = result.masks  # Masks object for segmentation masks outputs
    keypoints = result.keypoints  # Keypoints object for pose outputs
    probs = result.probs  # Class probabilities for classification outputs
```

- boxes ë‚´ë¶€ì—ëŠ” ê²€ì¶œëœ ì—¬ëŸ¬ bounding boxë“¤ì˜ ì¢Œí‘œë“¤ì´ ë°°ì—´ í˜•íƒœë¡œ ì €ì¥ë˜ì–´ ìˆìœ¼ë©°, ì´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¢Œí‘œë“¤ì€ ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ìœ¼ë¡œ í‘œí˜„ë˜ê³  ìˆë‹¤.

```python
boxes.xyxy  # box with xyxy format, (N, 4)
boxes.xywh  # box with xywh format, (N, 4)
boxes.xyxyn  # box with xyxy format but normalized, (N, 4)
boxes.xywhn  # box with xywh format but normalized, (N, 4)
boxes.conf  # confidence score, (N, )
boxes.cls  # cls, (N, )
boxes.data  # raw bboxes tensor, (N, 6) or boxes.boxes
```

### Bounding box í•¨ìˆ˜

- bounding box ê¸°ë³¸ ì˜µì…˜ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•˜ê¸° ìœ„í•´ Annotator í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.

```python
from ultralytics.utils.plotting import Annotator

for r in results:
	annotator = Annotator(frame)

	boxes = r.boxes
	for box in boxes:
    b = box.xyxy[0]
    c = box.cls
    annotator.box_label(b)
	
frame = annotator.result()
```

### ì°¨ëŸ‰ë²ˆí˜¸ ì •ë ¬

- ì°¨ëŸ‰ë²ˆí˜¸ëŠ” ê²€ì¶œëœ bounding boxì˜ left-topì˜ x ì¢Œí‘œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬ì„ ì§„í–‰í•œë‹¤.
- ë°°ì—´ í˜•íƒœë¡œ ì •ë ¬ë˜ê¸° ë•Œë¬¸ì— ë§ˆì§€ë§‰ ì—°ì‚°ìœ¼ë¡œ join ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í•˜ë‚˜ì˜ ë¬¸ìì—´ë¡œ í•©ì¹œë‹¤.

```python
classes = ['0','1','2','3','4',...,'E']

# ì°¨ëŸ‰ë²ˆí˜¸ ì •ë ¬ - left_top, xì¶• ì¤‘ì‹¬ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ
data = results[0].boxes.cpu().numpy().data
sorted_data = data[data[:,0].argsort()]
sorted_clsIdx = [int(row[5]) for row in sorted_data]

# ì°¨ëŸ‰ë²ˆí˜¸ ì¶œë ¥ - í´ë˜ìŠ¤ ë§¤ì¹­
car_number = ''.join(classes[idx] for idx in sorted_clsIdx)
print(car_number)
```

### ê²°ê³¼ í™”ë©´

<p align="center">
  <img src="./img/0727/0727_1.png" align="center" width="80%">
</p>

- ì¶”ë¡  ì†ë„ëŠ” CPU í™˜ê²½ì—ì„œ 750ms~1100ms ì‚¬ì´ë¡œ ë‹¤ì†Œ ëŠë¦° í¸ì´ë‹¤.

<p align="center">
  <img src="./img/0727/0727_2.png" align="center" width="80%">
</p>

<p align="center">
  <img src="./img/0727/0727_3.png" align="center" width="80%">
</p>

&nbsp;

## **ğŸ“Œ ëª©í‘œ ì„¤ì •**

- 4ì¼ì°¨ ë¼ë²¨ë§ ì‘ì—… ê³„ì†
- ì‹¤ì‹œê°„ ì˜ìƒì— ëŒ€í•´ì„œ LPR í…ŒìŠ¤íŠ¸
- GPU í™˜ê²½ì—ì„œ í•™ìŠµ ë° í…ŒìŠ¤íŠ¸ í•´ë³´ê¸°